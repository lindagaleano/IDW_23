<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reserva de Turnos - Clínica Buena Salud</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    h1 {
      text-align: center;
      margin-bottom: 30px;
      font-weight: 700;
      color: #212529;
    }
    .card {
      background-color: #212529;
      border: 1px solid #ffffff;
      border-radius: 15px;
      padding: 25px;
      color: #ffffff;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    label { color: #bfbfbf; }
    .form-control {
      background-color: #ffffff;
      color: #212529;
      border: none;
      border-radius: 8px;
    }
    .btn-reservar {
      background: linear-gradient(90deg, #000000, #000000);
      border: none;
      color: #ffffff;
      font-weight: 600;
      padding: 0.75rem 2.5rem;
      border-radius: 50px;
      display: block;
      margin: 0 auto;
    }
    footer {
      background-color: #000000;
      color: #ffffff;
      padding: 20px 0;
    }
  </style>
</head>
<body>

  <header>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark border-bottom border-body ">
      <div class="container-fluid">
        <a class="navbar-brand" href="index.html">
          <img src="Logo clínica.png" alt="Clínica Buena Salud" width="100" height="100" class="d-inline-block align-text-top">
          
        </a>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
          <div class="navbar-nav ms-auto">
            <a class="nav-link" href="index.html">Inicio</a>
            <a class="nav-link" href="contacto.html">Contacto</a>
            <a class="nav-link active" href="Turnos.html">Turnos</a>
            <a class="nav-link" href="institucional.html">Institucional</a>
            <a class="nav-link" href="admin.html">Administrador</a>
          </div>
        </div>
      </div>
    </nav>
  </header>

  <main class="container">
    <h1>Reserva de Turnos</h1>

    <div class="card">
      <form id="form-turno">
        <div class="row mb-3">
          <div class="col-md-4">
            <label class="form-label">Especialidad</label>
            <select id="especialidad" class="form-select" required>
              <option value="">Seleccionar especialidad...</option>
              <option value="Cardiología">Cardiología</option>
              <option value="Cirugía">Cirugía</option>
              <option value="Odontología">Odontología</option>
              <option value="Estudios Diagnósticos">Estudios Diagnósticos</option>
              <option value="Kinesiología y Fisioterapia">Kinesiología y Fisioterapia</option>
              <option value="Clínica Médica">Clínica Médica</option>
              <option value="Bienestar Mental">Bienestar Mental</option>
              <option value="Nutrición">Nutrición</option>
              <option value="Oftalmología">Oftalmología</option>
              <option value="Ortopedia y Traumatología">Ortopedia y Traumatología</option>
              <option value="Banco de Sangre">Banco de Sangre</option>
            </select>
          </div>

          <div class="col-md-4">
            <label class="form-label">Médico</label>
            <select id="medico" class="form-select" required>
              <option value="">Seleccionar médico...</option>
            </select>
          </div>

          <div class="col-md-4">
            <label for="obra" class="form-label">Obra Social</label>
            <select id="obra" class="form-control" required>
              <option value="">Seleccioná una opción</option>
              <option value="0|Sin obra social (0%)">Sin obra social (0%)</option>
              <option value="10|Pami (10%)">Pami (10%)</option>
              <option value="20|Osde (20%)">Osde (20%)</option>
              <option value="30|Medife (30%)">Medife (30%)</option>
              <option value="40|Galeno (40%)">Galeno (40%)</option>
              <option value="60|Swiss Medical (60%)">Swiss Medical (60%)</option>
            </select>
          </div>
        </div>

        <div class="row mb-4">
          <div class="col-md-6 offset-md-3">
            <label for="fecha" class="form-label">Seleccioná una fecha</label>
            <input type="date" id="fecha" class="form-control" required>
          </div>
        </div>

        <div class="row mb-4">
          <div class="col-md-6 offset-md-3">
            <label for="hora" class="form-label">Seleccioná una hora</label>
            <input type="time" id="hora" class="form-control" required>
          </div>
        </div>

        <div id="precio-final" class="text-center">
          Valor de la consulta: $30.000
        </div>

        <div class="progress-container text-center mt-3">
          <p id="progress-text">0% de descuento aplicado</p>
          <div class="progress mx-auto" style="max-width:300px;">
            <div class="progress-bar" id="progress-bar" style="width: 0%">0%</div>
          </div>
        </div>

        <div class="text-center mt-4">
          <button type="submit" class="btn-reservar">Reservar</button>
        </div>
      </form>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

  <!-- ========================= -->
  <!-- DESCUENTO Y PRECIO -->
  <!-- ========================= -->
  <script>
    const valorBase = 30000;

    function actualizarDescuento(porcentaje) {
      const bar = document.getElementById("progress-bar");
      const text = document.getElementById("progress-text");
      const precioFinal = document.getElementById("precio-final");

      bar.style.width = porcentaje + "%";
      bar.textContent = porcentaje + "%";
      text.textContent = porcentaje + "% de descuento aplicado";

      const valorConDescuento = valorBase - (valorBase * porcentaje / 100);
      precioFinal.textContent = "Valor de la consulta: $" + valorConDescuento.toLocaleString("es-AR");
    }

    document.getElementById("obra").addEventListener("change", (e) => {
      const porcentaje = parseInt(e.target.value) || 0;
      actualizarDescuento(porcentaje);
    });

    actualizarDescuento(0);
  </script>

  <!-- ========================= -->
  <!-- TURNO Y MÉDICOS -->
  <!-- ========================= -->
<script>
  // ================================
  // MÉDICOS FIJOS
  // ================================
  const medicosFijos = [
    { nombre: "Ana", apellido: "Gómez", especialidad: "Cardiología" },
    { nombre: "Juan", apellido: "Pérez", especialidad: "Cardiología" },
    { nombre: "María", apellido: "Rodríguez", especialidad: "Cirugía" }
  ];

  // ================================
  // MÉDICOS DEL ADMIN (localStorage)
  // ================================
  const medicosAdmin = JSON.parse(localStorage.getItem("medicos")) || [];

  
  const medicos = [...medicosFijos];

  medicosAdmin.forEach(m => {
    const yaExiste = medicos.some(
      f =>
        f.nombre.toLowerCase() === m.nombre.toLowerCase() &&
        f.apellido.toLowerCase() === m.apellido.toLowerCase() &&
        f.especialidad.toLowerCase() === m.especialidad.toLowerCase()
    );
    if (!yaExiste) medicos.push(m);
  });

  // ================================
  // FILTRAR MÉDICOS 
  // ================================
  document.getElementById("especialidad").addEventListener("change", function () {
    const especialidadSeleccionada = this.value.trim().toLowerCase();
    const selectMedico = document.getElementById("medico");
    selectMedico.innerHTML = '<option value="">Seleccionar médico...</option>';

    const filtrados = medicos.filter(
      m => m.especialidad && m.especialidad.toLowerCase() === especialidadSeleccionada
    );

    filtrados.forEach(m => {
      const option = document.createElement("option");
      option.value = `${m.nombre} ${m.apellido}`;
      option.textContent = `${m.nombre} ${m.apellido}`;
      selectMedico.appendChild(option);
    });
  });

  // ================================
  // GUARDAR TURNO
  // ================================
  document.getElementById("form-turno").addEventListener("submit", function (e) {
    e.preventDefault();

    const especialidad = document.getElementById("especialidad").value.trim();
    const medico = document.getElementById("medico").value.trim();
    const obraSelect = document.getElementById("obra");
    const obra = obraSelect.options[obraSelect.selectedIndex].text;
    const fecha = document.getElementById("fecha").value;
    const hora = document.getElementById("hora").value;

    if (!especialidad || !medico || !obra || !fecha || !hora) {
      alert("⚠️ Por favor completá todos los campos antes de reservar.");
      return;
    }

    const turno = { especialidad, medico, obra, fecha, hora };

    // Cargar, agregar y guardar sin duplicar turno idéntico
    const turnos = JSON.parse(localStorage.getItem("turnos")) || [];
    const yaExiste = turnos.some(
      t =>
        t.especialidad === especialidad &&
        t.medico === medico &&
        t.fecha === fecha &&
        t.hora === hora
    );

    if (yaExiste) {
      alert("⚠️ Este turno ya fue reservado.");
      return;
    }

    turnos.push(turno);
    localStorage.setItem("turnos", JSON.stringify(turnos));

    alert(`✅ Turno reservado con éxito:
Especialidad: ${especialidad}
Médico: ${medico}
Obra social: ${obra}
Fecha: ${fecha}
Hora: ${hora}`);

    this.reset();
    if (typeof actualizarDescuento === "function") actualizarDescuento(0);
  });
</script>


  <footer class="bg-dark text-light text-center py-3 mt-4">
    <p class="mb-0">&copy; 2025 Clínica Buena Salud. Todos los derechos reservados.</p>
  </footer>
</body>
</html>
